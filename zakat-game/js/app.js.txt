/**
 * ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­ÙƒÙ…Ø© Ø²ÙƒØ§Ø© Ø§Ù„ÙØ·Ø±
 * Ø§Ù„Ø¥ØµØ¯Ø§Ø±: 1.0.0
 * PWA Ready
 */

// --- ØªØ³Ø¬ÙŠÙ„ Service Worker ---
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js')
            .then(registration => {
                console.log('ServiceWorker registered:', registration.scope);
            })
            .catch(error => {
                console.log('ServiceWorker registration failed:', error);
            });
    });
}

// --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ ---
const cases = [
    {
        id: 1,
        title: "ØªØ£Ø®ÙŠØ± Ø§Ù„Ø²ÙƒØ§Ø©",
        defendantEmoji: "ğŸƒâ€â™‚ï¸",
        intro: "Ù‚Ø§Ù… Ø§Ù„Ù…ØªÙ‡Ù… Ø¨Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ø²ÙƒØ§Ø© Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ÙŠØ¯ Ø¨Ø³Ø§Ø¹ØªÙŠÙ†.",
        witnesses: {
            time: "ÙŠØ§ Ø³ÙŠØ§Ø¯Ø© Ø§Ù„Ù‚Ø§Ø¶ÙŠØŒ Ø±Ø£ÙŠØªÙ‡ ÙŠØ±ÙƒØ¶ Ù„Ù„ÙÙ‚Ø±Ø§Ø¡ ÙˆØ§Ù„Ø´Ù…Ø³ Ù‚Ø¯ Ø§Ø±ØªÙØ¹Øª ÙˆØ§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø© Ø§Ù„Ø¹ÙŠØ¯.",
            amount: "Ø£Ø®Ø±Ø¬ ÙƒÙŠØ³Ø§Ù‹ ÙƒØ¨ÙŠØ±Ø§Ù‹ ÙˆØ²Ù†Ù‡ 3 ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…Ø§Øª.",
            type: "Ø±Ø£ÙŠØª ÙÙŠ Ø§Ù„ÙƒÙŠØ³ Ø£Ø±Ø²Ø§Ù‹ ÙØ§Ø®Ø±Ø§Ù‹ Ù…Ù† Ù‚ÙˆØª Ø§Ù„Ø¨Ù„Ø¯."
        },
        isValid: false,
        correctReason: "ØªÙ… Ø¥Ø®Ø±Ø§Ø¬Ù‡Ø§ Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ÙŠØ¯",
        wrongReasons: ["Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± Ù‚Ù„ÙŠÙ„ Ø¬Ø¯Ø§Ù‹", "Ø§Ù„ØµÙ†Ù ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„"],
        explanation: "ÙŠØ£Ø«Ù… Ø¨ØªØ£Ø®ÙŠØ±Ù‡Ø§ Ø¹Ù† ØµÙ„Ø§Ø© Ø§Ù„Ø¹ÙŠØ¯ ÙˆØªØ¹ØªØ¨Ø± ØµØ¯Ù‚Ø© Ø¹Ø§Ø¯ÙŠØ© ÙˆÙ„ÙŠØ³Øª Ø²ÙƒØ§Ø© ÙØ·Ø±ØŒ Ù„Ø£Ù† ÙˆÙ‚ØªÙ‡Ø§ ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø§Ù„ØµÙ„Ø§Ø©."
    },
    {
        id: 2,
        title: "Ø§Ù„ØµÙ†Ù ØºÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨",
        defendantEmoji: "ğŸ’",
        intro: "Ø£Ø®Ø±Ø¬ Ø§Ù„Ù…ØªÙ‡Ù… Ø£Ù„Ø¹Ø§Ø¨Ø§Ù‹ ÙˆÙ…Ù„Ø§Ø¨Ø³ Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ù‚ÙŠÙ…Ø© Ø§Ù„Ø²ÙƒØ§Ø©.",
        witnesses: {
            time: "Ø£Ø®Ø±Ø¬Ù‡Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø¹ÙŠØ¯ Ø¨ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯.",
            amount: "ÙƒØ§Ù†Øª Ø§Ù„Ø­Ù‚ÙŠØ¨Ø© Ø«Ù‚ÙŠÙ„Ø© ÙˆÙ…Ù„ÙŠØ¦Ø© Ø¨Ø§Ù„Ø£Ø´ÙŠØ§Ø¡.",
            type: "Ù„Ù… ÙŠÙƒÙ† Ø·Ø¹Ø§Ù…Ø§Ù‹ ÙŠØ§ Ø³ÙŠØ¯ÙŠØŒ Ø¨Ù„ ÙƒØ§Ù†Øª Ø£Ù„Ø¹Ø§Ø¨ Ø£Ø·ÙØ§Ù„ ÙˆÙ…Ù„Ø§Ø¨Ø³ Ù…Ø³ØªØ¹Ù…Ù„Ø©."
        },
        isValid: false,
        correctReason: "Ø§Ù„ØµÙ†Ù Ù„ÙŠØ³ Ù…Ù† Ù‚ÙˆØª Ø§Ù„Ø¨Ù„Ø¯",
        wrongReasons: ["ØªÙ… Ø¥Ø®Ø±Ø§Ø¬Ù‡Ø§ ÙÙŠ ÙˆÙ‚Øª Ù…Ø¨ÙƒØ± Ø¬Ø¯Ø§Ù‹", "Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± Ø²Ø§Ø¦Ø¯ Ø¹Ù† Ø§Ù„Ø­Ø§Ø¬Ø©"],
        explanation: "Ø²ÙƒØ§Ø© Ø§Ù„ÙØ·Ø± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø·Ø¹Ø§Ù…Ø§Ù‹ (ØªÙ…Ø±Ø§Ù‹ØŒ Ø´Ø¹ÙŠØ±Ø§Ù‹ØŒ Ø£Ø±Ø²Ø§Ù‹..) ÙˆÙ„Ø§ ÙŠØ¬Ø²Ø¦ Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø£Ùˆ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù†Ù‡Ø§."
    },
    {
        id: 3,
        title: "Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„Ù†Ø§Ù‚Øµ",
        defendantEmoji: "ğŸ¥˜",
        intro: "Ø£Ø®Ø±Ø¬ Ø§Ù„Ù…ØªÙ‡Ù… Ø¹Ù„Ø¨Ø© ØµØºÙŠØ±Ø© Ù…Ù† Ø§Ù„ØªÙ…Ø±.",
        witnesses: {
            time: "Ø£Ø®Ø±Ø¬Ù‡Ø§ ÙˆÙ‡Ùˆ Ø°Ø§Ù‡Ø¨ Ù„ØµÙ„Ø§Ø© Ø§Ù„Ø¹ÙŠØ¯ØŒ Ù‚Ø¨Ù„ Ø§Ù„ØµÙ„Ø§Ø©.",
            amount: "ÙŠØ§ Ø³ÙŠØ¯ÙŠ ÙˆØ¶Ø¹ØªÙ‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙŠØ²Ø§Ù† ÙÙƒØ§Ù†Øª ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹ ÙÙ‚Ø·.",
            type: "ÙƒØ§Ù† ØªÙ…Ø±Ø§Ù‹ Ø¬ÙŠØ¯Ø§Ù‹ ÙˆÙ…ØºÙ„ÙØ§Ù‹."
        },
        isValid: false,
        correctReason: "Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„ØµØ§Ø¹ (3 ÙƒØ¬Ù…)",
        wrongReasons: ["Ø§Ù„ØªÙ…Ø± Ù„ÙŠØ³ Ù…Ù† Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©", "Ø§Ù„ÙˆÙ‚Øª Ù…ØªØ£Ø®Ø± Ø¬Ø¯Ø§Ù‹"],
        explanation: "Ø§Ù„ÙˆØ§Ø¬Ø¨ ØµØ§Ø¹ Ø¹Ù† ÙƒÙ„ Ø´Ø®ØµØŒ ÙˆØ§Ù„ØµØ§Ø¹ ÙŠÙ‚Ø¯Ø± Ø¨Ù€ 3 ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…Ø§Øª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹. Ø§Ù„ÙƒÙŠÙ„Ùˆ Ø§Ù„ÙˆØ§Ø­Ø¯ Ù„Ø§ ÙŠÙƒÙÙŠ."
    },
    {
        id: 4,
        title: "Ù‚Ø¶ÙŠØ© Ø³Ù„ÙŠÙ…Ø©",
        defendantEmoji: "ğŸ‘³",
        intro: "Ø±Ø¬Ù„ Ø£Ø®Ø±Ø¬ 3 ÙƒÙŠÙ„Ùˆ Ø£Ø±Ø² Ù„ÙŠÙ„Ø© Ø§Ù„Ø¹ÙŠØ¯.",
        witnesses: {
            time: "Ø³Ù„Ù…Ù‡Ø§ Ù„Ù„ÙÙ‚Ø±Ø§Ø¡ Ø¨Ø¹Ø¯ ØºØ±ÙˆØ¨ Ø´Ù…Ø³ Ø¢Ø®Ø± ÙŠÙˆÙ… ÙÙŠ Ø±Ù…Ø¶Ø§Ù†.",
            amount: "ÙƒØ§Ù† ÙƒÙŠØ³Ø§Ù‹ ÙŠØ²Ù† 3 ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…Ø§Øª Ø¨Ø§Ù„ØªÙ…Ø§Ù….",
            type: "ÙƒØ§Ù† Ø£Ø±Ø²Ø§Ù‹ Ø£Ø¨ÙŠØ¶Ø§Ù‹ Ù…Ù…Ø§ ÙŠØ£ÙƒÙ„Ù‡ Ø§Ù„Ù†Ø§Ø³."
        },
        isValid: true,
        correctReason: "Ø§Ø³ØªÙˆÙØª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø±ÙˆØ· (Ø§Ù„ÙˆÙ‚ØªØŒ Ø§Ù„Ù…Ù‚Ø¯Ø§Ø±ØŒ Ø§Ù„Ù†ÙˆØ¹)",
        wrongReasons: ["ÙƒØ§Ù† ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ®Ø±Ø¬ ØªÙ…Ø±Ø§Ù‹ ÙÙ‚Ø·", "ÙƒØ§Ù† ÙŠØ¬Ø¨ Ø¥Ø®Ø±Ø§Ø¬Ù‡Ø§ Ù‚Ø¨Ù„ Ø±Ù…Ø¶Ø§Ù†"],
        explanation: "Ø­ÙƒÙ… Ù…Ù…ØªØ§Ø²! Ø§Ù„ÙØ¹Ù„ ØµØ­ÙŠØ­: Ø£Ø®Ø±Ø¬ ØµØ§Ø¹Ø§Ù‹ (3 ÙƒØ¬Ù…) Ù…Ù† Ù‚ÙˆØª Ø§Ù„Ø¨Ù„Ø¯ (Ø§Ù„Ø£Ø±Ø²) ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø¨Ø§Ø­ (Ù„ÙŠÙ„Ø© Ø§Ù„Ø¹ÙŠØ¯)."
    }
];

// --- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© ---
let currentCaseIndex = 0;
let score = 0;
let currentCase = null;
let selectedVerdict = null;
let audioCtx = null;

// --- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØµÙˆØª ---
function initAudio() {
    if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    if (audioCtx.state === 'suspended') {
        audioCtx.resume();
    }
}

function playSound(type) {
    if (!audioCtx) initAudio();
    
    try {
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        const now = audioCtx.currentTime;

        if (type === 'click') {
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(600, now);
            gainNode.gain.setValueAtTime(0.05, now);
            oscillator.start(now);
            oscillator.stop(now + 0.1);
        } else if (type === 'correct') {
            oscillator.type = 'triangle';
            oscillator.frequency.setValueAtTime(500, now);
            oscillator.frequency.linearRampToValueAtTime(800, now + 0.1);
            gainNode.gain.setValueAtTime(0.1, now);
            oscillator.start(now);
            oscillator.stop(now + 0.3);
        } else if (type === 'wrong') {
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(300, now);
            oscillator.frequency.linearRampToValueAtTime(100, now + 0.2);
            gainNode.gain.setValueAtTime(0.1, now);
            oscillator.start(now);
            oscillator.stop(now + 0.3);
        }
    } catch (e) {
        console.warn('Audio playback failed', e);
    }
}

// --- Ø¯ÙˆØ§Ù„ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ---
function showScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
}

function updateScore() {
    document.getElementById('score').innerText = score;
}

function loadCase() {
    if (currentCaseIndex >= cases.length) {
        // Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ - Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
        // ÙŠÙ…ÙƒÙ†Ùƒ Ù‡Ù†Ø§ Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ø´Ø© Ù†Ù‡Ø§ÙŠØ© Ø®Ø§ØµØ©
        alert("Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§! Ø£Ø­Ø³Ù†Øª Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù‚Ø§Ø¶ÙŠ. Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©.");
        startGame();
        return;
    }

    currentCase = cases[currentCaseIndex];
    selectedVerdict = null;

    showScreen('court-screen');
    document.getElementById('case-title').innerText = `Ù‚Ø¶ÙŠØ©: ${currentCase.title}`;
    document.getElementById('defendant-emoji').innerText = currentCase.defendantEmoji;
    document.getElementById('speaker-name').innerText = "Ø§Ù„Ù…Ø­ÙƒÙ…Ø©";
    document.getElementById('dialogue-text').innerText = currentCase.intro + " .. Ø§Ø³ØªÙ…Ø¹ Ù„Ù„Ø´Ù‡ÙˆØ¯.";
    document.getElementById('judge-btn').style.display = 'none';
    
    document.querySelectorAll('.witness-btn').forEach(btn => {
        btn.classList.remove('active', 'visited');
        btn.style.display = 'block';
    });
}

function startGame() {
    initAudio();
    playSound('click');
    score = 0;
    currentCaseIndex = 0;
    updateScore();
    // Ø®Ù„Ø· Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    cases.sort(() => Math.random() - 0.5);
    loadCase();
}

// --- Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« (Event Listeners) ---
document.addEventListener('DOMContentLoaded', () => {
    
    // Ø²Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
    document.getElementById('start-btn').addEventListener('click', startGame);

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø´Ù‡ÙˆØ¯
    document.querySelectorAll('.witness-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            playSound('click');
            const type = this.getAttribute('data-type');
            
            document.querySelectorAll('.witness-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active', 'visited');

            let speaker = "";
            if (type === 'time') speaker = "Ø´Ø§Ù‡Ø¯ Ø§Ù„ÙˆÙ‚Øª â°";
            if (type === 'amount') speaker = "Ø´Ø§Ù‡Ø¯ Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± âš–ï¸";
            if (type === 'type') speaker = "Ø´Ø§Ù‡Ø¯ Ø§Ù„ØµÙ†Ù ğŸŒ¾";

            document.getElementById('speaker-name').innerText = speaker;
            document.getElementById('dialogue-text').innerText = currentCase.witnesses[type];

            // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ø­ÙƒÙ… Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø«Ù„Ø§Ø«Ø© Ø´Ù‡ÙˆØ¯
            const visited = document.querySelectorAll('.witness-btn.visited').length;
            if (visited >= 3) {
                document.getElementById('judge-btn').style.display = 'inline-block';
            }
        });
    });

    // Ø²Ø± ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø­ÙƒÙ…
    document.getElementById('judge-btn').addEventListener('click', () => {
        playSound('click');
        const modal = document.getElementById('verdict-modal');
        modal.style.display = 'flex';
        document.getElementById('reason-section').style.display = 'none';
        
        document.querySelectorAll('.verdict-btn').forEach(b => {
            b.classList.remove('selected');
            b.style.opacity = '1';
        });
    });

    // Ø£Ø²Ø±Ø§Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­ÙƒÙ… (ØµØ­ÙŠØ­/Ø®Ø·Ø£)
    document.querySelectorAll('.verdict-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            playSound('click');
            const isAccepted = this.getAttribute('data-verdict') === 'true';
            selectedVerdict = isAccepted;

            document.querySelectorAll('.verdict-btn').forEach(b => b.style.opacity = '0.5');
            this.style.opacity = '1';
            this.classList.add('selected');

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø­ÙƒÙ…
            const reasonsContainer = document.getElementById('reasons-container');
            reasonsContainer.innerHTML = '';
            document.getElementById('reason-section').style.display = 'block';

            let reasons = [];
            if (currentCase.isValid) {
                reasons.push(currentCase.correctReason);
                reasons.push("Ù„Ø£Ù† Ø§Ù„Ù…ØªÙ‡Ù… ÙÙ‚ÙŠØ±");
                reasons.push("Ù„Ø£Ù† Ø§Ù„ÙŠÙˆÙ… Ø¹ÙŠØ¯");
            } else {
                reasons = [...currentCase.wrongReasons, currentCase.correctReason];
            }
            
            // Ø®Ù„Ø· Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨
            reasons.sort(() => Math.random() - 0.5);

            reasons.forEach(reason => {
                const rBtn = document.createElement('button');
                rBtn.className = 'choice-btn';
                rBtn.innerText = reason;
                rBtn.onclick = () => submitJudgment(reason);
                reasonsContainer.appendChild(rBtn);
            });
        });
    });

    // Ø²Ø± Ø§Ù„Ù‚Ø¶ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
    document.getElementById('next-case-btn').addEventListener('click', () => {
        playSound('click');
        currentCaseIndex++;
        loadCase();
    });
});

function submitJudgment(reason) {
    document.getElementById('verdict-modal').style.display = 'none';
    showScreen('result-screen');
    
    const gavel = document.getElementById('gavel-anim');
    const content = document.getElementById('result-content');
    content.style.display = 'none';
    gavel.style.display = 'block';
    gavel.classList.add('strike');

    setTimeout(() => {
        const isVerdictCorrect = (selectedVerdict === currentCase.isValid);
        const isReasonCorrect = (reason === currentCase.correctReason);

        gavel.classList.remove('strike');
        gavel.style.display = 'none';
        content.style.display = 'block';

        const title = document.getElementById('result-title');
        const icon = document.getElementById('result-icon');
        const feedback = document.getElementById('result-feedback');

        if (isVerdictCorrect && isReasonCorrect) {
            playSound('correct');
            score += 10;
            title.innerText = "Ø­ÙƒÙ… ØµØ­ÙŠØ­! ğŸŒŸ";
            title.className = "correct";
            icon.innerText = "âœ…";
            feedback.innerHTML = `<strong>Ù…Ù…ØªØ§Ø²!</strong> ${currentCase.explanation}`;
        } else {
            playSound('wrong');
            title.innerText = "Ø­ÙƒÙ… Ø®Ø§Ø·Ø¦ ğŸ˜”";
            title.className = "wrong";
            icon.innerText = "âŒ";
            let errorMsg = "";
            if (!isVerdictCorrect) errorMsg = "Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙƒØ§Ù† Ø®Ø§Ø·Ø¦Ø§Ù‹.";
            else if (!isReasonCorrect) errorMsg = "Ø§Ù„Ù‚Ø±Ø§Ø± ØµØ­ÙŠØ­ Ù„ÙƒÙ† Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø°ÙŠ Ø§Ø®ØªØ±ØªÙ‡ ØºÙŠØ± Ø¯Ù‚ÙŠÙ‚.";
            
            feedback.innerHTML = `<strong>${errorMsg}</strong><br><br>Ø§Ù„ØµÙˆØ§Ø¨: ${currentCase.explanation}`;
        }
        updateScore();
    }, 800);
}